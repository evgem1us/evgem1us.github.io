---
sidebar_position: 3
---

# Обязательные компоненты на основной аватар

На корень аватара (префаб аватара на сцене) накидываем компонент `AAO Trace and Optimize`. Настройки обычно достаточно оставить по умолчанию.

![Trace and Optimize](/img/guides/nondestructive_optimization/image-59.png)

Этот компонент автоматически (на версии AAO не менее v1.8.14):
- Применит к аватару настроенные блендшейпы, которые не меняются анимациями
- Удалит неиспользуемые объекты
- Проводит небольшую оптимизацию PhysBones, например, объединит одинаковые PhysBones Colliders
- Оптимизирует аниматор, если может:
  - Превращает слои, состоящие из AnyState и простых тогглов в BlendTree (на практике работает не всегда)
  - Объединит разные слои с BlendTree в один
  - Удалит неиспользуемые слои
- Объединит Skinned Meshes
- Оптимизирует текстуры для поддерживаемых шейдеров (но для каких - документация не признается)

Полный список выполняемых действий есть на [сайте с документацией](https://vpm.anatawa12.com/avatar-optimizer/en/docs/reference/trace-and-optimize/), но там описано не сильно подробнее.

Для совместимости с MMD мирами оставьте галочку `MMD World Compatibility` включенной и добавьте в корень аватара компонент `MA VRChat Settings` (нужно для аниматора), там тоже должна быть включена похожая галочка.

> TODO Проверить достаточно ли этого для MMD с аватарами, у которых в аниматоре не используется Write Defaults.
